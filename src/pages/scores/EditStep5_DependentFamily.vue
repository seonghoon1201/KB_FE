<!-- src/pages/score/Step5.vue -->
<template>
    <ScoreStepWrapper>
        <!-- λ‹¨κ³„ ν‘μ‹ -->
        <div class="flex justify-start pb-4">
            <span class="text-lg text-gray-500">5/6</span>
        </div>
        <!-- ν—¤λ“λΌμΈ -->
        <div class="px-4 pb-4">
            <h2 class="text-xl font-bold">λ¶€μ–‘κ°€μ΅±μ„ μ„ νƒν•΄μ£Όμ„Έμ”</h2>
            <p class="text-sm text-gray-500 mt-1">
                μ²­μ•½ μ μ κ³„μ‚°μ— κ°€μ¥ μ¤‘μ”ν• μ •λ³΄μμ”. λ¶€μ–‘κ°€μ΅± μ„¤λ…μ„ μ°Έκ³ ν•΄μ£Όμ„Έμ”
            </p>
        </div>

        <ul class="divide-y divide-gray-200">
            <!-- λ°°μ°μ -->
            <li class="flex justify-between items-center py-4 px-4">
                <div class="flex flex-col">
                    <div class="flex items-center gap-2">
                        <span class="font-medium">λ°°μ°μ</span>
                        <InfoTooltip title="λ°°μ°μ λ¶€μ–‘κ°€μ΅± κΈ°μ¤€">
                            <ul class="list-disc list-inside text-base text-gray-600 space-y-2">
                                <li>
                                    λ°°μ°μκ°€ λ‚μ™€ μ„Έλ€κ°€ λ¶„λ¦¬λμ–΄ μμ–΄λ„ λ¬΄μ£Όνƒ μƒνƒλΌλ©΄ λ¶€μ–‘κ°€μ΅±μ—
                                    ν¬ν•¨λΌμ”
                                </li>
                                <li>
                                    λ¶€μ–‘κ°€μ΅±μΈ λ°°μ°μ(λ³ΈμΈ ν¬ν•¨)κ°€ 2μ£Όνƒ μ΄μƒμ„ μ†μ ν• κ²½μ°, μ†μ 
                                    μ£Όνƒ μλ§λ‹¤ 5μ μ”© κ°μ λΌμ”<br />
                                    ex) 2μ£Όνƒ μ†μ : 10μ  κ°μ 
                                </li>
                            </ul>
                        </InfoTooltip>
                    </div>
                    <span class="text-sm text-gray-500 mt-1">λ¬΄μ£Όνƒ</span>
                </div>
                <div class="flex items-center gap-2">
                    <button
                        @click="spouse = 1"
                        :class="[
                            'w-10 h-8 rounded-full border font-medium',
                            spouse === 1
                                ? 'bg-blue-500 text-white border-blue-500'
                                : 'bg-gray-100 text-gray-700 border-gray-200',
                        ]"
                    >
                        O
                    </button>
                    <button
                        @click="spouse = 0"
                        :class="[
                            'w-10 h-8 rounded-full border font-medium',
                            spouse === 0
                                ? 'bg-blue-500 text-white border-blue-500'
                                : 'bg-gray-100 text-gray-700 border-gray-200',
                        ]"
                    >
                        X
                    </button>
                </div>
            </li>

            <!-- λ¬΄μ£Όνƒ λ¶€λ¨ -->
            <li class="flex justify-between items-center py-4 px-4">
                <div class="flex flex-col">
                    <div class="flex items-center gap-2">
                        <span class="font-medium">λ¬΄μ£Όνƒ λ¶€λ¨ (λ°°μ°μ λ¶€λ¨ ν¬ν•¨)</span>
                        <InfoTooltip title="λ¶€λ¨ λ¶€μ–‘κ°€μ΅± κΈ°μ¤€">
                            <ul class="list-disc list-inside text-base text-gray-600 space-y-2">
                                <li>
                                    λ³ΈμΈ / λ°°μ°μμ λ¶€λ¨λ‹ λ¨λ‘ λ¬΄μ£Όνƒμ΄μ–΄μ•Ό ν•΄μ”. λν•
                                    μ£Όλ―Όλ“±λ΅λ“±λ³Έμ— μµκ·Ό 3λ…„ μ΄μƒ λ“±μ¬λμ–΄ μμ–΄μ•Ό μΈμ •λΌμ”. λ¶€λ¨λ‹μ΄
                                    λ§ 60μ„Έ μ΄μƒμ΄μ‹λΌλ©΄ μ£Όνƒμ„ μ†μ ν•μ…”λ„ λ¶€μ–‘κ°€μ΅±μΌλ΅ μΈμ •λΌμ”
                                </li>
                                <li>
                                    λ§ 60μ„Έ μ΄μƒ λ¶€λ¨κ°€ 2μ£Όνƒ μ΄μƒμ„ μ†μ ν•μ‹  κ²½μ°, 1μ£Όνƒ μ΄κ³Ό
                                    μ£Όνƒλ§λ‹¤ 5μ μ”© κ°μ λΌμ”<br />
                                    ex) 2μ£Όνƒ μ†μ : 5μ  κ°μ 
                                </li>
                            </ul>
                        </InfoTooltip>
                    </div>
                    <span class="text-sm text-gray-500 mt-1">λ§ 60μ„Έ μ΄μƒμ΄λ©΄ μ μ£Όνƒλ„ κ°€λ¥</span>
                </div>
                <DependentCounter v-model="parents" />
            </li>

            <!-- μλ…€ -->
            <li class="flex justify-between items-center py-4 px-4">
                <div class="flex flex-col">
                    <div class="flex items-center gap-2">
                        <span class="font-medium">μλ…€</span>
                        <InfoTooltip title="μλ…€ λ¶€μ–‘κ°€μ΅± κΈ°μ¤€">
                            <ul class="list-disc list-inside text-base text-gray-600 space-y-2">
                                <li>
                                    λ§ 30μ„Έ λ―Έλ§μ λ―ΈνΌ μλ…€λ” λ¶€μ–‘κ°€μ΅±μΌλ΅ μΈμ •λΌμ”. λ§ 30μ„Έ μ΄μƒμ
                                    λ―ΈνΌ μλ…€λ” μ£Όλ―Όλ“±λ΅λ“±λ³Έμ— μµκ·Ό 1λ…„ μ΄μƒ λ“±μ¬λμ–΄ μμ–΄μ•Ό
                                    μΈμ •λΌμ”
                                </li>
                                <li>
                                    λ¶€μ–‘κ°€μ΅±μΈ μλ…€κ°€ 2μ£Όνƒ μ΄μƒμ„ μ†μ ν• κ²½μ°, μ†μ  μ£Όνƒ μλ§λ‹¤
                                    5μ μ”© κ°μ λΌμ”<br />
                                    ex) 2μ£Όνƒ μ†μ : 10μ  κ°μ 
                                </li>
                            </ul>
                        </InfoTooltip>
                    </div>
                    <span class="text-sm text-gray-500 mt-1">λ¬΄μ£Όνƒ / λ―ΈνΌμ</span>
                </div>
                <DependentCounter v-model="children" />
            </li>
        </ul>

        <PrimaryButton class="mt-8" @click="next">λ‹¤μ</PrimaryButton>
    </ScoreStepWrapper>
</template>

<script setup>
import { ref, onMounted } from 'vue'
import { useRouter } from 'vue-router'
import { useScoreStore } from '@/stores/scoreStore'
import ScoreStepWrapper from '@/components/score/ScoreStepWrapper.vue'
import InfoTooltip from '@/components/score/InfoTooltip.vue'
import PrimaryButton from '@/components/common/PrimaryButton.vue'
import DependentCounter from '@/components/score/DependentCounter.vue'

const router = useRouter()
const scoreStore = useScoreStore()

// λ΅μ»¬ μƒνƒ
const spouse = ref(0) // λ°°μ°μ: 1 or 0
const parents = ref(0) // λ¶€λ¨ μ
const children = ref(0) // μλ…€ μ

onMounted(() => {
    if (scoreStore.maritalStatus === 1) {
        spouse.value = 1 // νΌμΈν–μΌλ©΄ O
    } else {
        spouse.value = 0 // νΌμΈ μ•ν–μΌλ©΄ X
    }
})

async function next() {
    const total = spouse.value + parents.value + children.value
    console.log('π‘ λ¶€μ–‘κ°€μ΅± μ ν•©μ‚°:', {
        spouse: spouse.value,
        parents: parents.value,
        children: children.value,
        total,
    })

    scoreStore.dependentsNm = total
    scoreStore.saveToLocal()
    console.log('π’Ύ μ €μ¥λ dependentsNm:', scoreStore.dependentsNm)

    await scoreStore.calculateScore()
    router.push('/score/info')
}
</script>
